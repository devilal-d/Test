<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"/>
    <title>Kesari Style Player</title>
    
    <link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css"/>
    
    <style>
        /* UI MATCHING YOUR PICTURE */
        :root {
            --plyr-color-main: #ff0000; /* Bright Red Progress Bar */
            --plyr-video-background: #000;
        }

        body, html { 
            margin: 0; padding: 0; width: 100%; height: 100%; 
            background: #000; overflow: hidden; 
            display: flex; align-items: center; justify-content: center;
        }

        .player-wrapper { 
            width: 100%; height: 100%; 
            display: flex; align-items: center; 
        }

        /* Customize Control Bar to look like the mobile screenshot */
        .plyr--full-ui {
            --plyr-control-spacing: 12px;
            --plyr-control-radius: 4px;
        }

        /* Make the seek bar thicker like the screenshot */
        .plyr__progress__container {
            height: 6px;
        }
        
        /* Center big Play/Pause button styling */
        .plyr--video .plyr__control--overlaid {
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid #fff;
        }

        /* Hide ads/external elements */
        iframe, .ads, #recollectsideway {
            display: none !important;
            visibility: hidden !important;
        }
    </style>
</head>
<body>

<div class="player-wrapper">
    <video id="player" playsinline crossorigin></video>
</div>

<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<script src="https://cdn.plyr.io/3.7.8/plyr.js"></script>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const video = document.getElementById('player');
    
    // Get URL Parameter
    const urlParams = new URLSearchParams(window.location.search);
    const source = urlParams.get('dtv');

    if (!source) {
        alert("Please add ?dtv=LINK to the URL");
        return;
    }

    // Plyr Configuration
    const player = new Plyr(video, {
        controls: [
            'play-large', // Middle button
            'play',        // Bottom play
            'progress',    // Red Bar
            'current-time', 
            'duration', 
            'mute', 
            'volume', 
            'settings', 
            'fullscreen'
        ],
        tooltips: { controls: true, seek: true },
        keyboard: { focused: true, global: true }
    });

    // HLS Support Logic
    if (Hls.isSupported()) {
        const hls = new Hls({
            capLevelToPlayerSize: true,
            autoStartLoad: true
        });
        
        hls.loadSource(source);
        hls.attachMedia(video);
        
        hls.on(Hls.Events.MANIFEST_PARSED, function () {
            // Quality Settings
            const availableQualities = hls.levels.map((l) => l.height);
            player.config.quality = {
                default: availableQualities[0],
                options: availableQualities,
                forced: true,
                onChange: (newQuality) => {
                    hls.levels.forEach((level, levelIndex) => {
                        if (level.height === newQuality) {
                            hls.currentLevel = levelIndex;
                        }
                    });
                }
            };
            
            // Start playback (muted to ensure browser allows it)
            video.muted = true;
            video.play();
        });

        window.hls = hls;
    } 
    else if (video.canPlayType('application/vnd.apple.mpegurl')) {
        // Fallback for Safari/iOS
        video.src = source;
    }
});
</script>

</body>
</html>
